<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1200">
  <title>TibiaVault â€” Tibia Companion Guide</title>
  <meta name="description" content="TibiaVault: Comprehensive Tibia MMORPG companion â€” Bestiary, Hunting Spots, Equipment, Quests, Spells, Interactive Map, Character Lookup, and more.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="css/style.css?v=20">
  <style>
    .map-tip{background:var(--bg-card)!important;border:1px solid var(--border)!important;color:var(--parchment)!important;font-family:'Crimson Text',serif!important;font-size:12px!important;padding:6px 10px!important;border-radius:var(--r)!important;box-shadow:0 4px 12px rgba(0,0,0,.5)!important}
    .map-tip::before{border-top-color:var(--bg-card)!important}
    .map-city-label{background:none!important;border:none!important}
    .leaflet-control-zoom a{background:var(--bg-card)!important;color:var(--gold)!important;border-color:var(--border)!important}
    .leaflet-popup-content-wrapper{background:var(--bg-card)!important;color:var(--parchment)!important;border:1px solid var(--border)!important;border-radius:var(--r)!important}
    .leaflet-popup-tip{background:var(--bg-card)!important}
    .leaflet-popup-close-button{color:var(--gold)!important}
  </style>
</head>
<body>
  <div class="app">

    <!-- ===== TOPBAR ===== -->
    <header class="topbar">
      <div class="tb-logo">
        <img src="images/ideogram-v3.0_TibiaPedia_medieval_fantasy_logo_ornate_golden_text_on_transparent_dark_backgrou-0.jpg" alt="TibiaVault">
        <span><b>Tibia</b>Vault</span>
      </div>
      <div class="tb-search">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" id="globalSearch" placeholder="Search creatures, quests, spells...">
      </div>
      <div class="tb-right">
        <div class="boosted" id="boostedCreature">
          <div class="boosted-info"><span class="blabel">Boosted</span><span class="bname">Loading...</span></div>
        </div>
        <div class="boosted" id="boostedBoss">
          <div class="boosted-info"><span class="blabel">Boss</span><span class="bname">Loading...</span></div>
        </div>
      </div>
    </header>

    <!-- ===== SIDEBAR ===== -->
    <nav class="sidebar">
      <div class="sidebar-nav">
        <div class="nav-item active" data-panel="news">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Tibia_Coins.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>News</span>
        </div>
        <div class="nav-item" data-panel="bestiary">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Creature_Products.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Bestiary</span>
        </div>
        <div class="nav-item" data-panel="hunting">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Sword.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Hunting System</span>
        </div>
        <div class="nav-item" data-panel="equipment">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Magic_Plate_Armor.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Equipment</span>
        </div>
        <div class="nav-item" data-panel="quests">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Treasure_Chest.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Quest Guide</span>
        </div>
        <div class="nav-item" data-panel="spells">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Spellbook.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Spells</span>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-item" data-panel="map">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Map_(Item).gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>World Map</span>
        </div>
        <div class="nav-item" data-panel="character">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Citizen_Male.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Character</span>
        </div>
        <div class="nav-item" data-panel="worlds">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Globe.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Worlds</span>
        </div>
        <div class="nav-item" data-panel="calculators">
          <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Crystal_Coin.gif" alt="" class="ni-icon" onerror="this.style.display='none'">
          <span>Calculators</span>
        </div>
        <div class="nav-divider"></div>
        <a href="https://discord.gg/dknTHjkYCg" target="_blank" class="nav-item nav-discord" style="text-decoration:none">
          <img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/636e0a69f118df70ad7828d4_icon_clyde_blurple_RGB.svg" alt="" class="ni-icon" onerror="this.textContent='ðŸ’¬'">
          <span>Join Discord</span>
          <span style="font-size:9px;background:var(--gold);color:var(--bg);padding:1px 6px;border-radius:8px;font-weight:700;margin-left:auto">NEW</span>
        </a>
      </div>
      <div class="sidebar-footer">
        Portfolio Demo by<br><a href="https://grindarestudio.com" target="_blank">Grindare Studio</a>
      </div>
    </nav>

    <!-- ===== CONTENT ===== -->
    <main class="content">

      <!-- NEWS -->
      <section class="panel active" id="p-news">
        <div class="ph"><h2>Latest News</h2><p>Stay updated with the latest from Tibia</p><div class="ph-line"></div></div>
        <div class="news-grid">
          <div id="newsList"></div>
          <div class="news-side">
            <div class="card">
              <h4>Boosted Creature</h4>
              <div id="newsBoostedCreature" style="font-size:13px;color:var(--parch-dim)">Loading...</div>
            </div>
            <div class="card">
              <h4>Boosted Boss</h4>
              <div id="newsBoostedBoss" style="font-size:13px;color:var(--parch-dim)">Loading...</div>
            </div>
          </div>
        </div>
      </section>

      <!-- BESTIARY -->
      <section class="panel" id="p-bestiary">
        <div class="ph"><h2>Bestiary</h2><p>Browse all Tibia creatures with stats, resistances and loot</p><div class="ph-line"></div></div>
        <div id="bestiaryList">
          <div class="filters">
            <input type="text" id="bestiarySearch" class="si" placeholder="Search creatures..." oninput="state.bestiary.search=this.value;filterBestiary()">
          </div>
          <div class="rcount" id="bestiaryCount">Loading...</div>
          <div class="cg" id="bestiaryGrid"></div>
          <div class="pag" id="bestiaryPag"></div>
        </div>
        <div class="cd" id="creatureDetail"></div>
      </section>

      <!-- HUNTING SYSTEM -->
      <section class="panel" id="p-hunting">
        <div class="ph"><h2>Hunting System</h2><p>Community-driven hunting spots, routes, and the route editor</p><div class="ph-line"></div></div>

        <!-- Welcome/Onboarding Modal (first visit) -->
        <div class="hw-overlay" id="huntWelcome" style="display:none">
          <div class="hw-box">
            <div class="hw-header">
              <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Citizen_Male.gif" onerror="this.style.display='none'" class="hw-avatar">
              <div>
                <h3>Welcome, Adventurer!</h3>
                <p>Set up your character to see personalized hunting spots</p>
              </div>
            </div>
            <div class="hw-fields">
              <div class="hw-field">
                <label>Character Name <span style="color:var(--parch-dim)">(optional)</span></label>
                <input type="text" id="hwName" placeholder="e.g. Bubble Knight">
              </div>
              <div class="hw-field">
                <label>Level</label>
                <input type="number" id="hwLevel" value="150" min="8" max="9999">
              </div>
              <div class="hw-field">
                <label>Vocation</label>
                <div class="hw-vocs">
                  <button class="hw-voc active" data-voc="knight" onclick="hwPickVoc(this)"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Knight_Male.gif" onerror="this.style.display='none'"><span>Knight</span></button>
                  <button class="hw-voc" data-voc="paladin" onclick="hwPickVoc(this)"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Hunter_Male.gif" onerror="this.style.display='none'"><span>Paladin</span></button>
                  <button class="hw-voc" data-voc="sorcerer" onclick="hwPickVoc(this)"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Mage_Male.gif" onerror="this.style.display='none'"><span>Sorcerer</span></button>
                  <button class="hw-voc" data-voc="druid" onclick="hwPickVoc(this)"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Summoner_Male.gif" onerror="this.style.display='none'"><span>Druid</span></button>
                  <button class="hw-voc" data-voc="monk" onclick="hwPickVoc(this)"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Monk_Male.gif" onerror="this.style.display='none'"><span>Monk</span></button>
                </div>
              </div>
            </div>
            <div class="hw-actions">
              <button class="btn-s btn-g hw-go" onclick="hwSave()">Find My Hunting Spots</button>
              <button class="btn-s hw-skip" onclick="hwSkip()">Skip for now</button>
            </div>
          </div>
        </div>

        <!-- CTA Banner -->
        <div class="hunt-cta" id="huntCta">
          <div class="cta-inner">
            <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Tibia_Coins.gif" alt="" class="cta-icon" onerror="this.style.display='none'">
            <div class="cta-text"><b>Help Build the Best Route Database!</b> Submit new guides to enter the <b>250 TC weekly draw</b> Â· Fix spots to enter the <b>50 TC weekly draw</b></div>
            <div class="cta-actions">
              <button class="btn-s btn-g" onclick="switchHuntTab('editor',document.querySelector('.hunt-tab-create'))">Route Editor</button>
              <a href="https://discord.gg/dknTHjkYCg" target="_blank" class="btn-s">Discord</a>
            </div>
          </div>
          <button class="cta-close" onclick="this.parentElement.style.display='none';localStorage.setItem('tv_cta_closed','1')">&times;</button>
        </div>

        <!-- Sub-tabs -->
        <div class="hunt-tabs">
          <button class="hunt-tab active" onclick="switchHuntTab('browse',this,'solo')">Solo Hunts</button>
          <button class="hunt-tab" onclick="switchHuntTab('browse',this,'duo')">Duo Hunts</button>
          <button class="hunt-tab" onclick="switchHuntTab('browse',this,'team')">Team Hunts</button>
          <button class="hunt-tab hunt-tab-create" onclick="switchHuntTab('editor',this)">+ Create Route</button>
        </div>
        <!-- TAB: Browse Spots -->
        <div class="hunt-tab-content active" id="htab-browse">
        <!-- My Build Bar (horizontal) -->
        <div class="my-build">
          <div class="build-label"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Citizen_Male.gif" onerror="this.style.display='none'" style="width:24px;height:24px"> My Build</div>
          <div class="build-char">
            <input type="text" id="myCharName" placeholder="Character name..." autocomplete="off" onkeydown="if(event.key==='Enter')lookupMyBuild()">
            <button class="btn-g" onclick="lookupMyBuild()">Lookup</button>
          </div>
          <div class="build-level"><label>Lv</label><input type="number" id="myLevel" value="150" min="8" max="999" oninput="state.hunting.myLevel=+this.value||150;renderHunting()"></div>
          <div class="build-sep"></div>
          <div class="build-vocs">
            <button class="bv active" onclick="setMyVoc(this,'knight')"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Magic_Plate_Armor.gif" onerror="this.textContent='EK'"><span>EK</span></button>
            <button class="bv" onclick="setMyVoc(this,'paladin')"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Royal_Crossbow.gif" onerror="this.textContent='RP'"><span>RP</span></button>
            <button class="bv" onclick="setMyVoc(this,'sorcerer')"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Wand_of_Inferno.gif" onerror="this.textContent='MS'"><span>MS</span></button>
            <button class="bv" onclick="setMyVoc(this,'druid')"><img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Hailstorm_Rod.gif" onerror="this.textContent='ED'"><span>ED</span></button>
            <button class="bv" onclick="setMyVoc(this,'monk')"><img src="https://tibiopedia.pl/images/static/items/traditional_sai.gif" onerror="this.textContent='MO'"><span>MO</span></button>
          </div>
        </div>
        <!-- Character Info Panel -->
        <div class="build-info" id="buildInfo">
          <div class="bi-overlay" id="biOverlay">
            <img src="https://tibia.fandom.com/wiki/Special:Redirect/file/Outfit_Citizen_Male.gif" onerror="this.style.display='none'" class="bi-overlay-icon">
            <span>Enter your character name and click <b>Lookup</b> to see detailed statistics</span>
          </div>
          <div class="bi-stats-row" id="biStats">
            <div class="bi-stat"><span class="bi-num" id="biTotal">â€”</span><span class="bi-lbl">Total Spots</span></div>
            <div class="bi-stat bi-stat-hl"><span class="bi-num" id="biForYou">â€”</span><span class="bi-lbl">For Your Level</span></div>
            <div class="bi-stat"><span class="bi-num" id="biVerified">â€”</span><span class="bi-lbl">Verified Routes</span></div>
            <div class="bi-stat bi-stat-hl"><span class="bi-num" id="biVocMatch">â€”</span><span class="bi-lbl">For Your Vocation</span></div>
          </div>
          <div class="bi-char" id="biChar"></div>
        </div>
        <div class="filters">
          <div class="fg">
            <button class="fb active" onclick="setHuntVoc(this,'all')">All Vocations</button>
            <button class="fb" onclick="setHuntVoc(this,'knight')">EK</button>
            <button class="fb" onclick="setHuntVoc(this,'paladin')">RP</button>
            <button class="fb" onclick="setHuntVoc(this,'sorcerer')">MS</button>
            <button class="fb" onclick="setHuntVoc(this,'druid')">ED</button>
            <button class="fb" onclick="setHuntVoc(this,'monk')">MO</button>
          </div>
          <input type="number" placeholder="Min level" style="width:90px" oninput="state.hunting.levelMin=+this.value||0;renderHunting()">
          <input type="number" placeholder="Max level" style="width:90px" oninput="state.hunting.levelMax=+this.value||9999;renderHunting()">
          <span class="rcount" id="huntCount" style="margin-left:auto"></span>
        </div>
        <div id="huntingGrid"></div>
        </div><!-- /htab-browse -->
        <!-- TAB: Route Editor -->
        <div class="hunt-tab-content" id="htab-editor">
        <div class="ed-toolbar">
          <button class="btn-s btn-g ed-mode-btn active" data-mode="new" onclick="editorSetMode('new',this)">New Spot</button>
          <button class="btn-s ed-mode-btn" data-mode="fix" onclick="editorSetMode('fix',this)">Fix Existing</button>
          <select id="edFixSpot" class="ed-spot-select" style="display:none" onchange="editorLoadSpot(+this.value)">
            <option value="-1">-- Select spot to fix --</option>
          </select>
          <div style="margin-left:auto;display:flex;gap:6px">
            <button class="btn-s" onclick="editorUndo()" title="Undo last waypoint">Undo</button>
            <button class="btn-s" onclick="editorClear()" title="Clear all">Clear All</button>
          </div>
        </div>
        <div class="ed-layout">
          <div class="ed-map-wrap">
            <div id="editorMap" class="ed-map"></div>
            <div class="ed-map-ctrl">
              <button class="btn-s" onclick="editorFloor(-1)" title="Go up">â–²</button>
              <span id="edFloorLabel">Ground (7)</span>
              <button class="btn-s" onclick="editorFloor(1)" title="Go down">â–¼</button>
              <span id="edMapCoords" style="margin-left:12px;color:var(--gold);font-size:11px"></span>
            </div>
          </div>
          <div class="ed-sidebar">
            <div class="ed-wp-header">
              <h4>Waypoints</h4>
              <span class="ed-wp-count" id="edWpCount">0 steps</span>
            </div>
            <div class="ed-wp-list" id="edWpList">
              <div class="ed-wp-empty">Click on the map to add waypoints</div>
            </div>
            <div class="ed-form">
              <h4>Spot Details</h4>
              <div class="ed-field">
                <label>Spot Name</label>
                <input type="text" id="edName" placeholder="e.g. Asura Palace">
              </div>
              <div class="ed-field">
                <label>Nearest City</label>
                <select id="edCity"></select>
              </div>
              <div class="ed-field-row">
                <div class="ed-field">
                  <label>Min Level</label>
                  <input type="number" id="edLvlMin" placeholder="130" min="1" max="9999">
                </div>
                <div class="ed-field">
                  <label>Max Level</label>
                  <input type="number" id="edLvlMax" placeholder="400" min="1" max="9999">
                </div>
              </div>
              <div class="ed-field">
                <label>Vocations</label>
                <div class="ed-vocs">
                  <label><input type="checkbox" value="knight" checked> EK</label>
                  <label><input type="checkbox" value="paladin" checked> RP</label>
                  <label><input type="checkbox" value="sorcerer" checked> MS</label>
                  <label><input type="checkbox" value="druid" checked> ED</label>
                </div>
              </div>
              <div class="ed-field">
                <label>Hunt Modes</label>
                <div class="ed-hunt-modes">
                  <label class="ed-hm"><input type="checkbox" value="solo" checked> Solo
                    <span class="ed-hm-range"><input type="number" placeholder="Min" class="ed-hm-min"> â€“ <input type="number" placeholder="Max" class="ed-hm-max"> <label class="ed-hm-same"><input type="checkbox" checked onchange="toggleHMRange(this)"> Same as spot</label></span>
                  </label>
                  <label class="ed-hm"><input type="checkbox" value="duo"> Duo
                    <span class="ed-hm-range"><input type="number" placeholder="Min" class="ed-hm-min"> â€“ <input type="number" placeholder="Max" class="ed-hm-max"> <label class="ed-hm-same"><input type="checkbox" checked onchange="toggleHMRange(this)"> Same as spot</label></span>
                  </label>
                  <label class="ed-hm"><input type="checkbox" value="team"> Team
                    <span class="ed-hm-range"><input type="number" placeholder="Min" class="ed-hm-min"> â€“ <input type="number" placeholder="Max" class="ed-hm-max"> <label class="ed-hm-same"><input type="checkbox" checked onchange="toggleHMRange(this)"> Same as spot</label></span>
                  </label>
                </div>
              </div>
              <div class="ed-field">
                <label>Access / Quest Requirements</label>
                <textarea id="edAccess" rows="2" placeholder="e.g. Free access, no quest needed"></textarea>
              </div>
              <div class="ed-field">
                <label>Route Description</label>
                <textarea id="edRoute" rows="3" placeholder="e.g. Start at Ankrahmun depot, head south through desert..."></textarea>
              </div>

              <h4 style="margin-top:14px">Creatures & Details</h4>
              <div class="ed-field">
                <label>Creatures (one per line: Name, HP, XP)</label>
                <textarea id="edCreatures" rows="4" placeholder="e.g.&#10;Werebear, 2400, 2550&#10;Werefox, 1350, 1650&#10;Wereboar, 2100, 2000"></textarea>
              </div>
              <div class="ed-field">
                <label>Imbuements (recommended)</label>
                <textarea id="edImbuements" rows="2" placeholder="e.g. T3 Vampirism (axe), T3 Void (helmet), T2 Fire Strike"></textarea>
              </div>
              <div class="ed-field">
                <label>Supplies per Vocation (one line per voc)</label>
                <textarea id="edSupplies" rows="4" placeholder="e.g.&#10;EK: 200 supreme health, 100 spirit potions&#10;ED: 300 great mana, 50 avalanche runes&#10;RP: 200 great spirit, 100 diamond arrows"></textarea>
              </div>
              <div class="ed-field">
                <label>Best Equipment (per vocation/level)</label>
                <textarea id="edEquipment" rows="4" placeholder="e.g.&#10;EK 300+: Falcon Plate, Soulbastion, Gnome Helmet, Pair of Soulwalkers&#10;ED 250+: Gill Gugel, Dawnfire Sherwani, Dream Shroud"></textarea>
              </div>
              <div class="ed-field">
                <label>Valuable Drops</label>
                <textarea id="edDrops" rows="2" placeholder="e.g. Werewolf Fur, Dreaded Cleaver, Fur Armor, Werewolf Amulet"></textarea>
              </div>
              <div class="ed-field">
                <label>Hunting Tips</label>
                <textarea id="edTips" rows="2" placeholder="e.g. Pull 3-4 at a time, avoid running into Wereboar packs..."></textarea>
              </div>
              <div class="ed-field">
                <label>EXP/h (estimated)</label>
                <input type="text" id="edExpH" placeholder="e.g. 2.5kk/h or 2,500,000">
              </div>
              <div class="ed-field">
                <label>Profit/h (estimated)</label>
                <input type="text" id="edProfitH" placeholder="e.g. 150k/h or -50k/h (waste)">
              </div>

              <h4 style="margin-top:14px">Your Info</h4>
              <div class="ed-field">
                <label>Your Tibia Character Name <span style="color:var(--fire)">*required</span></label>
                <input type="text" id="edAuthor" placeholder="e.g. Bubble Knight" required>
                <div style="font-size:10px;color:var(--parch-dim);margin-top:3px">Tibia Coins rewards are sent to this character. Must be exact in-game name.</div>
              </div>
              <div class="ed-reward-info" style="padding:10px 12px;background:rgba(212,165,55,.06);border:1px solid rgba(212,165,55,.15);border-radius:var(--r);font-size:11px;color:var(--parch-dim);line-height:1.6;margin-bottom:10px">
                <b style="color:var(--gold)">Rewards:</b><br>
                â˜… <b>New full spot</b> = Route Creator role + entry into 250 TC weekly giveaway draw<br>
                â˜… <b>Edit existing spot</b> = Spot Editor role + entry into 50 TC weekly giveaway draw
              </div>
              <div class="ed-actions">
                <button class="btn-s" onclick="editorPreview()">Preview Route</button>
                <button class="btn-s btn-g" onclick="editorSubmit()">Submit to Review</button>
              </div>
            </div>
          </div>
        </div>
        <div class="ed-status" id="edStatus"></div>
        </div><!-- /htab-editor -->
      </section>

      <!-- EQUIPMENT -->
      <section class="panel" id="p-equipment">
        <div class="ph"><h2>Equipment Planner</h2><p>Best-in-slot gear for every vocation and level range</p><div class="ph-line"></div></div>
        <div class="eq-ctrl">
          <div class="fg">
            <button class="fb active" onclick="setEquipVoc(this,'knight')">Knight</button>
            <button class="fb" onclick="setEquipVoc(this,'paladin')">Paladin</button>
            <button class="fb" onclick="setEquipVoc(this,'sorcerer')">Sorcerer</button>
            <button class="fb" onclick="setEquipVoc(this,'druid')">Druid</button>
          </div>
          <select onchange="state.equip.bracket=this.value;renderEquipment()">
            <option value="8-30">Level 8-30</option>
            <option value="30-60">Level 30-60</option>
            <option value="60-100">Level 60-100</option>
            <option value="100-150">Level 100-150</option>
            <option value="150-200">Level 150-200</option>
            <option value="200-300">Level 200-300</option>
            <option value="300+">Level 300+</option>
          </select>
        </div>
        <div class="eq-grid" id="equipGrid"></div>
      </section>

      <!-- QUESTS -->
      <section class="panel" id="p-quests">
        <div class="ph"><h2>Quest Guide</h2><p>Step-by-step walkthroughs for Tibia's major quests</p><div class="ph-line"></div></div>
        <div class="filters">
          <input type="text" class="si" placeholder="Search quests..." oninput="state.quests.search=this.value;renderQuests()">
          <input type="number" placeholder="Your level" style="width:100px" oninput="state.quests.level=+this.value||0;renderQuests()">
          <div class="fg">
            <button class="fb active" onclick="setQuestPrem(this,'all')">All</button>
            <button class="fb" onclick="setQuestPrem(this,'free')">Free</button>
            <button class="fb" onclick="setQuestPrem(this,'premium')">Premium</button>
          </div>
        </div>
        <div class="ql" id="questList"></div>
      </section>

      <!-- SPELLS -->
      <section class="panel" id="p-spells">
        <div class="ph"><h2>Spells</h2><p>Complete spell database with vocation filters</p><div class="ph-line"></div></div>
        <div class="filters">
          <input type="text" class="si" placeholder="Search spells..." oninput="state.spells.search=this.value;filterSpells()">
          <div class="fg">
            <button class="fb active" onclick="setSpellVoc(this,'all')">All</button>
            <button class="fb" onclick="setSpellVoc(this,'knight')">Knight</button>
            <button class="fb" onclick="setSpellVoc(this,'paladin')">Paladin</button>
            <button class="fb" onclick="setSpellVoc(this,'sorcerer')">Sorcerer</button>
            <button class="fb" onclick="setSpellVoc(this,'druid')">Druid</button>
          </div>
          <div class="fg">
            <button class="fb active" onclick="setSpellType(this,'all')">All Types</button>
            <button class="fb" onclick="setSpellType(this,'Instant')">Instant</button>
            <button class="fb" onclick="setSpellType(this,'Rune')">Rune</button>
          </div>
        </div>
        <div class="rcount" id="spellCount">Loading...</div>
        <div class="sp-wrap">
          <table class="sp-tbl">
            <thead><tr><th></th><th>Name</th><th>Formula</th><th>Lv</th><th>Mana</th><th>Price</th><th>Vocation</th><th>Type</th></tr></thead>
            <tbody id="spellsBody"></tbody>
          </table>
        </div>
      </section>

      <!-- MAP -->
      <section class="panel" id="p-map">
        <div class="ph"><h2>World Map</h2><p>Interactive map of the Tibian continent</p><div class="ph-line"></div></div>
        <div class="map-ctrl">
          <label>Floor:</label>
          <button class="btn-s" onclick="changeFloor(Math.max(0,state.mapFloor-1))" title="Go up">â–²</button>
          <span id="floorLabel">Ground (7)</span>
          <button class="btn-s" onclick="changeFloor(Math.min(15,state.mapFloor+1))" title="Go down">â–¼</button>
          <span id="mapCoords" style="margin-left:16px;color:var(--gold)"></span>
        </div>
        <div id="tibiaMap"></div>
        <div class="map-legend">
          <span><span class="ld ld-blue"></span> Cities</span>
          <span><span class="ld ld-gold"></span> Hunting Spots</span>
        </div>
      </section>

      <!-- CHARACTER -->
      <section class="panel" id="p-character">
        <div class="ph"><h2>Character Lookup</h2><p>Search for any Tibia character</p><div class="ph-line"></div></div>
        <div class="ch-box">
          <input type="text" id="charInput" placeholder="Enter character name..." onkeydown="if(event.key==='Enter')lookupCharacter()">
          <button onclick="lookupCharacter()">Search</button>
        </div>
        <div id="charResult"></div>
      </section>

      <!-- WORLDS -->
      <section class="panel" id="p-worlds">
        <div class="ph"><h2>World Status</h2><p>Live server status for all Tibia worlds</p><div class="ph-line"></div></div>
        <div class="w-stats">
          <div class="w-stat"><div class="wv" id="totalOnline">--</div><div class="wl">Players Online</div></div>
          <div class="w-stat"><div class="wv" id="totalWorlds">--</div><div class="wl">Total Worlds</div></div>
        </div>
        <div class="filters">
          <input type="text" class="si" placeholder="Search worlds..." oninput="state.worlds.search=this.value;filterWorlds()">
        </div>
        <div class="w-wrap">
          <table class="w-tbl">
            <thead><tr>
              <th style="cursor:pointer" onclick="sortWorlds('name')">Name</th>
              <th style="cursor:pointer" onclick="sortWorlds('status')">Status</th>
              <th style="cursor:pointer" onclick="sortWorlds('players_online')">Online</th>
              <th style="cursor:pointer" onclick="sortWorlds('location')">Location</th>
              <th style="cursor:pointer" onclick="sortWorlds('pvp_type')">PvP</th>
              <th>BattlEye</th>
            </tr></thead>
            <tbody id="worldsBody"></tbody>
          </table>
        </div>
      </section>

      <!-- CALCULATORS -->
      <section class="panel" id="p-calculators">
        <div class="ph"><h2>Calculators</h2><p>Useful tools for your Tibian adventures</p><div class="ph-line"></div></div>
        <div class="calc-grid">

          <div class="card calc">
            <h3>Experience Calculator</h3>
            <div class="cf">
              <label>Current Level</label>
              <input type="number" id="calcCurrLevel" value="100" min="1" max="9999" oninput="calcExperience()">
            </div>
            <div class="cf">
              <label>Target Level</label>
              <input type="number" id="calcTgtLevel" value="200" min="2" max="9999" oninput="calcExperience()">
            </div>
            <div class="cf">
              <label>XP per Hour</label>
              <input type="number" id="calcXpH" value="1000000" min="1" oninput="calcExperience()">
            </div>
            <div class="cr" id="expResult"></div>
          </div>

          <div class="card calc">
            <h3>Loot Split</h3>
            <div class="cf">
              <label>Hunt Analyzer / Balance Text</label>
              <textarea id="calcLootText" rows="4" style="width:100%;background:var(--bg-input);color:var(--parchment);border:1px solid var(--border);border-radius:var(--r);padding:7px;font-family:'Crimson Text',serif;font-size:13px;resize:vertical" placeholder="Paste hunt analyzer text or total gold amount..." oninput="calcLootSplit()"></textarea>
            </div>
            <div class="cf">
              <label>Number of Players</label>
              <input type="number" id="calcPlayers" value="4" min="1" max="20" oninput="calcLootSplit()">
            </div>
            <div class="cr" id="lootResult"></div>
          </div>

          <div class="card calc">
            <h3>Stamina Calculator</h3>
            <div class="cf">
              <label>Current Stamina (Hours)</label>
              <input type="number" id="calcStamH" value="30" min="0" max="42" oninput="calcStamina()">
            </div>
            <div class="cf">
              <label>Minutes</label>
              <input type="number" id="calcStamM" value="0" min="0" max="59" oninput="calcStamina()">
            </div>
            <div class="cr" id="stamResult"></div>
          </div>

        </div>
      </section>

    </main>
  </div>

  <!-- Hunt Spot Detail Modal -->
  <div class="hunt-modal-overlay" id="huntModal" style="display:none">
    <div class="hunt-modal">
      <button class="hunt-modal-close" onclick="closeHuntModal()">&times;</button>
      <div class="hunt-modal-content" id="huntModalContent"></div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="js/data.js?v=20"></script>
  <script src="js/app.js?v=20"></script>
  <script>
    // Filter helpers for inline onclick handlers
    function setHuntVoc(btn, voc) {
      btn.parentElement.querySelectorAll('.fb').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.hunting.voc = voc;
      renderHunting();
    }
    function setEquipVoc(btn, voc) {
      btn.parentElement.querySelectorAll('.fb').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.equip.voc = voc;
      renderEquipment();
    }
    function setQuestPrem(btn, val) {
      btn.parentElement.querySelectorAll('.fb').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.quests.premium = val;
      renderQuests();
    }
    function setSpellVoc(btn, voc) {
      btn.parentElement.querySelectorAll('.fb').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.spells.voc = voc;
      filterSpells();
    }
    function setSpellType(btn, type) {
      btn.parentElement.querySelectorAll('.fb').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.spells.type = type;
      filterSpells();
    }
  </script>
</body>
</html>
